!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.creed={})}(this,function(t){"use strict";var e=1,n=2,r=4,o=n|r,i=8,c=16;function u(t){return(t.state()&n)>0}function s(t){return(t.state()&r)>0}function p(t){return(t.state()&o)>0}function a(t){return(t.state()&i)>0}function f(t){return(t.state()&c)>0}function h(t){t._runAction(l)}var l={fulfilled:function(){},rejected:function(t){t._state|=c}},y="undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process),d="function"==typeof MutationObserver&&MutationObserver||"function"==typeof WebKitMutationObserver&&WebKitMutationObserver,v=function(t){return y&&process.env[t]},_=v("CREED_DEBUG")||"development"===v("NODE_ENV")||"test"===v("NODE_ENV");function m(t){return y?(n=t,function(){return process.nextTick(n)}):d?function(t){var e=document.createTextNode("");new d(t).observe(e,{characterData:!0});var n=0;return function(){e.data=n^=1}}(t):(e=t,function(){return setTimeout(e,0)});var e,n}var w=function(){var t=this;this.tasks=new Array(65536),this.length=0,this.drain=m(function(){return t._drain()})};w.prototype.add=function(t){0===this.length&&this.drain(),this.tasks[this.length++]=t},w.prototype._drain=function(){for(var t=this.tasks,e=0;e<this.length;++e)t[e].run(),t[e]=void 0;this.length=0};var b,j=function(){},g=j,A=function(t,e){return g(b,t,e)},k=function(t){var e=b;return b=t,e},x=function(t,e){g=t,b=e},O=function(){return x(E,void 0)},E=function(t,e,n){return new R(t,n||e.name,e)},T=Error.captureStackTrace||j,R=function(t,e,n){this.next=t,this.tag=e,this.name=e?" from "+e+":":" from previous context:",T(this,n)};R.prototype.toString=function(){return this.name};var S=function(t,e){return null!=e?function(t,e){t instanceof Error&&!("_creed$OriginalStack"in t)&&(t._creed$OriginalStack=t.stack,t.stack=function t(e,n){if(null==n)return e;var r=N(n.stack);return t(r.indexOf(" at ")<0?e:e+"\n"+r,n.next)}(N(t.stack),e));return t}(t,e):t};var P=/\s*at\s.*(creed[\\/](src|dist)[\\/]|\((\w+|internal[\\/].+\.js)).+:\d.*/g,N=function(t){return"string"==typeof t?t.replace(P,""):""},F=function(t,e){this.rejections=[],this.emit=t,this.reportError=e};function D(t,e){try{!function(t,e){for(var n=0;n<t.length;++n){var r=t[n];f(r)||e(r)}}(e,t)}finally{e.length=0}}F.prototype.track=function(t){var e=S(t.value,t.context);this.emit("unhandledRejection",t,e)||(0===this.rejections.length&&setTimeout(D,1,this.reportError,this.rejections),this.rejections.push(t))},F.prototype.untrack=function(t){h(t),this.emit("rejectionHandled",t)};var M="unhandledRejection";function H(){}function V(t){return("object"==typeof t||"function"==typeof t)&&null!==t}var z=function(t){this.promise=t,this.context=A(this.constructor)};function C(t,e,n,r){var o;try{o=t(e)}catch(t){return void r._reject(t)}n(r,o)}function q(t,e,n,r){return n._when(new K(t,e,r)),r}z.prototype.fulfilled=function(t){this.promise._become(t)},z.prototype.rejected=function(t){return this.promise._become(t),!1};var K=function(t){function e(e,n,r){t.call(this,r),this.f=e,this.r=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.fulfilled=function(t){this.runThen(this.f,t)},e.prototype.rejected=function(t){return this.runThen(this.r,t)},e.prototype.runThen=function(t,e){return"function"!=typeof t?(this.promise._become(e),!1):(C(t,e.value,W,this.promise),!0)},e}(z);function W(t,e){t._resolve(e)}var $=function(t){function e(e,n,r){t.call(this,r),this.resolve=e,this.f=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.fulfilled=function(t){this.runFinally(this.f,t)},e.prototype.rejected=function(t){return this.runFinally(this.f,t)},e.prototype.runFinally=function(t,e){var n;try{n=t()}catch(t){return this.promise._reject(t),!0}return this.handleFinally(e,n)},e.prototype.handleFinally=function(t,e){return V(e)?(this.resolve(e)._when(new B(t,this.promise)),!0):(this.promise._become(t),!1)},e}(z),B=function(t){function e(e,n){t.call(this,n),this.result=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.fulfilled=function(t){s(this.result)?this.promise._reject(this.result.value):this.promise._become(this.result)},e}(z);function G(t,e,n){return e._when(new U(t,n)),n}var U=function(t){function e(e,n){t.call(this,n),this.f=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.fulfilled=function(t){C(this.f,t.value,I,this.promise)},e}(z);function I(t,e){t._fulfill(e)}function J(t,e,n,r){return n._when(new L(t,e,r)),r}var L=function(t){function e(e,n,r){t.call(this,n,r),this.r=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.rejected=function(t){C(this.r,t.value,Q,this.promise)},e}(U);function Q(t,e){t._reject(e)}function X(t,e,n){return e._when(new Y(t,n)),n}var Y=function(t){function e(e,n){t.call(this,n),this.f=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.fulfilled=function(t){C(this.f,t.value,Z,this.promise)},e}(z);function Z(t,e){V(e)&&"function"==typeof e.then||t._reject(new TypeError("f must return a promise")),t._resolve(e)}var tt=function(){};tt.prototype.valueAt=function(t,e,n){n._fulfill(t)},tt.prototype.fulfillAt=function(t,e,n){n._become(t)},tt.prototype.rejectAt=function(t,e,n){n._isResolved()?h(t):n._become(t)},tt.prototype.complete=function(t,e){0===t&&e._become(e.constructor.empty())};var et=function(t,e){this.pending=0,this.results=e,this.mergeHandler=t};function nt(t){return Array.isArray(t)?new Array(t.length):[]}function rt(t,e,n,r){for(var o=0;o<n.length;++o)it(t,e,n[o],o,r);e.complete(o,r)}function ot(t,e,n,r){for(var o=0,i=n[Symbol.iterator]();;){var c=i.next();if(c.done)break;it(t,e,c.value,o++,r)}e.complete(o,r)}function it(t,e,n,r,o){if(V(n)){var i=t(n);o._isResolved()?u(i)||h(i):u(i)?e.fulfillAt(i,r,o):s(i)?e.rejectAt(i,r,o):i._runAction(new ct(e,r,o))}else e.valueAt(n,r,o)}et.prototype.valueAt=function(t,e,n){this.results[e]=t,this.check(this.pending-1,n)},et.prototype.fulfillAt=function(t,e,n){this.valueAt(t.value,e,n)},et.prototype.rejectAt=function(t,e,n){n._isResolved()?h(t):n._become(t)},et.prototype.complete=function(t,e){this.check(this.pending+t,e)},et.prototype.check=function(t,e){this.pending=t,0===t&&this.mergeHandler.merge(e,this.results)};var ct=function(t){function e(e,n,r){t.call(this,r),this.i=n,this.handler=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.fulfilled=function(t){this.handler.fulfillAt(t,this.i,this.promise)},e.prototype.rejected=function(t){return this.handler.rejectAt(t,this.i,this.promise)},e}(z);var ut,st=(function(t){t.exports={equals:"fantasy-land/equals",lte:"fantasy-land/lte",compose:"fantasy-land/compose",id:"fantasy-land/id",concat:"fantasy-land/concat",empty:"fantasy-land/empty",invert:"fantasy-land/invert",filter:"fantasy-land/filter",map:"fantasy-land/map",contramap:"fantasy-land/contramap",ap:"fantasy-land/ap",of:"fantasy-land/of",alt:"fantasy-land/alt",zero:"fantasy-land/zero",reduce:"fantasy-land/reduce",traverse:"fantasy-land/traverse",chain:"fantasy-land/chain",chainRec:"fantasy-land/chainRec",extend:"fantasy-land/extend",extract:"fantasy-land/extract",bimap:"fantasy-land/bimap",promap:"fantasy-land/promap"}}(ut={exports:{}},ut.exports),ut.exports),pt=new w,at=new F(y&&"function"==typeof process.emit?function(t,e){return t===M?process.emit(t,e.value,e):process.emit(t,e)}:"undefined"!=typeof self&&"function"==typeof CustomEvent?function(t,e,n){var r;try{r=new n(M)instanceof n}catch(t){r=!1}return r?function(t,r){var o=new n(t,{detail:{reason:r.value,promise:r},bubbles:!1,cancelable:!0});return!e.dispatchEvent(o)}:t}(H,self,CustomEvent):H,function(t){throw t.value}),ft=function(){this.context=b};ft.empty=function(){return mt()},ft.of=function(t){return wt(t)},ft[st.empty]=function(){return mt()},ft[st.of]=function(t){return wt(t)},ft.prototype.finally=function(t){return"function"==typeof t?(e=vt,n=t,r=this.near(),o=new ht,r._when(new $(e,n,o)),o):this;var e,n,r,o},ft.prototype[st.map]=function(t){return this.map(t)},ft.prototype[st.bimap]=function(t,e){return this.bimap(t,e)},ft.prototype[st.ap]=function(t){return t.ap(this)},ft.prototype[st.chain]=function(t){return this.chain(t)},ft.prototype[st.concat]=function(t){return this.concat(t)},ft.prototype[st.alt]=function(t){return this.or(t)},ft[st.zero]=function(){return mt()},ft.prototype.concat=function(t){return this.or(t)};var ht=function(t){function n(){t.call(this),this.ref=void 0,this.action=void 0,this.length=0}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.then=function(t,e){var r=this.near();return r===this?q(t,e,this,new n):r.then(t,e)},n.prototype.catch=function(t){var e=this.near();return e===this?q(void 0,t,this,new n):e.catch(t)},n.prototype.map=function(t){var e=this.near();return e===this?G(t,this,new n):e.map(t)},n.prototype.bimap=function(t,e){var r=this.near();return r===this?J(t,e,this,new n):r.bimap(t,e)},n.prototype.ap=function(t){var e=this.near(),n=t.near();return e===this?this.chain(function(t){return n.map(t)}):e.ap(n)},n.prototype.chain=function(t){var e=this.near();return e===this?X(t,this,new n):e.chain(t)},n.prototype.or=function(t){var e=this.near(),n=t.near();return p(e)||a(n)?e:p(n)||a(e)?n:gt([e,n])},n.prototype.toString=function(){return"[object "+this.inspect()+"]"},n.prototype.inspect=function(){var t=this.near();return t===this?"Promise { pending }":t.inspect()},n.prototype.near=function(){return this._isResolved()?(this.ref=this.ref.near(),this.ref):this},n.prototype.state=function(){return this._isResolved()?this.ref.near().state():e},n.prototype._isResolved=function(){return void 0!==this.ref},n.prototype._when=function(t){this._runAction(t)},n.prototype._runAction=function(t){void 0===this.action?this.action=t:this[this.length++]=t},n.prototype._resolve=function(t){this._become(vt(t))},n.prototype._fulfill=function(t){this._become(new lt(t))},n.prototype._reject=function(t){this._isResolved()||this.__become(new yt(t))},n.prototype._become=function(t){this._isResolved()||this.__become(t)},n.prototype.__become=function(t){this.ref=t===this?new yt(new TypeError("resolution cycle")):t,void 0!==this.action&&pt.add(this)},n.prototype.run=function(){var t=this.ref.near();t._runAction(this.action),this.action=void 0;for(var e=0;e<this.length;++e)t._runAction(this[e]),this[e]=void 0},n}(ft),lt=function(t){function e(e){t.call(this),this.value=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.then=function(t){return"function"==typeof t?q(t,void 0,this,new ht):this},e.prototype.catch=function(){return this},e.prototype.map=function(t){return G(t,this,new ht)},e.prototype.bimap=function(t,e){return this.map(e)},e.prototype.ap=function(t){return t.map(this.value)},e.prototype.chain=function(t){return X(t,this,new ht)},e.prototype.or=function(){return this},e.prototype.toString=function(){return"[object "+this.inspect()+"]"},e.prototype.inspect=function(){return"Promise { fulfilled: "+this.value+" }"},e.prototype.state=function(){return n},e.prototype.near=function(){return this},e.prototype._when=function(t){pt.add(new Et(t,this))},e.prototype._runAction=function(t){var e=k(t.context);t.fulfilled(this),k(e)},e}(ft),yt=function(t){function e(e){t.call(this),this.value=e,this._state=r,at.track(this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.then=function(t,e){return"function"==typeof e?this.catch(e):this},e.prototype.catch=function(t){return q(void 0,t,this,new ht)},e.prototype.map=function(){return this},e.prototype.bimap=function(t){return J(t,void 0,this,new ht)},e.prototype.ap=function(){return this},e.prototype.chain=function(){return this},e.prototype.or=function(){return this},e.prototype.toString=function(){return"[object "+this.inspect()+"]"},e.prototype.inspect=function(){return"Promise { rejected: "+this.value+" }"},e.prototype.state=function(){return this._state},e.prototype.near=function(){return this},e.prototype._when=function(t){pt.add(new Et(t,this))},e.prototype._runAction=function(t){var e=k(t.context);t.rejected(this)&&at.untrack(this),k(e)},e}(ft),dt=function(t){function n(){t.apply(this,arguments)}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n.prototype.then=function(){return this},n.prototype.catch=function(){return this},n.prototype.finally=function(){return this},n.prototype.map=function(){return this},n.prototype.bimap=function(){return this},n.prototype.ap=function(){return this},n.prototype.chain=function(){return this},n.prototype.or=function(t){return t},n.prototype.toString=function(){return"[object "+this.inspect()+"]"},n.prototype.inspect=function(){return"Promise { never }"},n.prototype.state=function(){return e|i},n.prototype.near=function(){return this},n.prototype._when=function(){},n.prototype._runAction=function(){},n}(ft);function vt(t){return kt(t)?t.near():V(t)?Ot(wt,t):new lt(t)}function _t(t){return new yt(t)}function mt(){return new dt}function wt(t){return new lt(t)}function bt(t){return At(new et(jt,nt(t)),t)}var jt={merge:function(t,e){t._fulfill(e)}};function gt(t){return At(new tt,t)}function At(t,e){return"object"!=typeof(n=e)||null===n?_t(new TypeError("expected an iterable")):function(t,e,n,r){var o=Array.isArray(n)?rt:ot;try{o(t,e,n,r)}catch(t){r._reject(t)}return r.near()}(xt,t,e,new ht);var n}function kt(t){return t instanceof ft}function xt(t){return kt(t)?t.near():Ot(wt,t)}function Ot(t,e){try{var n=e.then;return"function"==typeof n?function(t,e){var n=new ht;try{t.call(e,function(t){return n._resolve(t)},function(t){return n._reject(t)})}catch(t){n._reject(t)}return n.near()}(n,e):t(e)}catch(t){return new yt(t)}}var Et=function(t,e){this.action=t,this.promise=e};Et.prototype.run=function(){this.promise._runAction(this.action)};var Tt=function(t){function e(e,n){t.call(this,n),this.time=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.fulfilled=function(t){setTimeout(Rt,this.time,t,this.promise)},e}(z);function Rt(t,e){e._become(t)}var St=function(t){function e(n){t.call(this),this.message=n,this.name=e.name,"function"==typeof t.captureStackTrace&&t.captureStackTrace(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error);var Pt=function(t){function e(e,n){t.call(this,n),this.timer=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.fulfilled=function(t){clearTimeout(this.timer),this.promise._become(t)},e.prototype.rejected=function(e){return clearTimeout(this.timer),t.prototype.rejected.call(this,e)},e}(z);function Nt(t){t._reject(new St("promise timeout"))}var Ft=function(){this.pending=0};Ft.prototype.valueAt=function(t,e,n){n._fulfill(t)},Ft.prototype.fulfillAt=function(t,e,n){n._become(t)},Ft.prototype.rejectAt=function(t,e,n){h(t),this.check(this.pending-1,n)},Ft.prototype.complete=function(t,e){this.check(this.pending+t,e)},Ft.prototype.check=function(t,e){this.pending=t,0===t&&e._reject(new RangeError("No fulfilled promises in input"))};var Dt=function(t,e){this.pending=0,this.results=e,this.resolve=t};function Mt(t,e,n,r){function o(t){var e=k(r.context);r._resolve(t),k(e)}function i(t){var e=k(r.context);r._reject(t),k(e)}switch(n.length){case 0:t.call(e,o,i);break;case 1:t.call(e,n[0],o,i);break;case 2:t.call(e,n[0],n[1],o,i);break;case 3:t.call(e,n[0],n[1],n[2],o,i);break;default:n.push(o,i),t.apply(e,n)}return r}function Ht(t,e,n,r){function o(t,e){var n=k(r.context);t?r._reject(t):r._fulfill(e),k(n)}switch(n.length){case 0:t.call(e,o);break;case 1:t.call(e,n[0],o);break;case 2:t.call(e,n[0],n[1],o);break;case 3:t.call(e,n[0],n[1],n[2],o);break;default:n.push(o),t.apply(e,n)}return r}Dt.prototype.valueAt=function(t,e,n){this.settleAt(this.resolve(t),e,n)},Dt.prototype.fulfillAt=function(t,e,n){this.settleAt(t,e,n)},Dt.prototype.rejectAt=function(t,e,n){h(t),this.settleAt(t,e,n)},Dt.prototype.settleAt=function(t,e,n){this.results[e]=t,this.check(this.pending-1,n)},Dt.prototype.complete=function(t,e){this.check(this.pending+t,e)},Dt.prototype.check=function(t,e){this.pending=t,0===t&&e._fulfill(this.results)};var Vt=function(t){function e(e,n,r){t.call(this,r),this.resolve=e,this.generator=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.run=function(){this.tryStep(this.generator.next,void 0)},e.prototype.tryStep=function(t,e){var n,r=k(this.context);try{n=t.call(this.generator,e)}catch(t){return void this.handleReject(t)}finally{k(r)}this.handleResult(n)},e.prototype.handleResult=function(t){if(t.done)return this.promise._resolve(t.value);this.resolve(t.value)._when(this)},e.prototype.handleReject=function(t){this.promise._reject(t)},e.prototype.fulfilled=function(t){this.tryStep(this.generator.next,t.value)},e.prototype.rejected=function(t){return this.tryStep(this.generator.throw,t.value),!0},e}(z);function zt(t,e,n,r,o){!function(t){if("function"!=typeof t)throw new TypeError("must provide a resolver function")}(e);try{t(e,n,r,o)}catch(t){o._reject(t)}return o}_&&O();var Ct=function(t,e){this.context=A(this.constructor,et.name),this.f=t,this.c=e,this.promise=void 0,this.args=void 0};Ct.prototype.merge=function(t,e){this.promise=t,this.args=e,pt.add(this)},Ct.prototype.run=function(){var t=k(this.context);try{this.promise._resolve(this.f.apply(this.c,this.args))}catch(t){this.promise._reject(t)}k(t)};var qt=[],Kt=function(t){function e(e){t.call(this),zt(Mt,e,void 0,qt,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(ht);function Wt(){var t="function"==typeof Promise&&Promise;return"undefined"!=typeof self?self.Promise=Kt:"undefined"!=typeof global&&(global.Promise=Kt),t}Kt.resolve=vt,Kt.reject=_t,Kt.all=bt,Kt.race=gt,"function"!=typeof Promise&&Wt(),t.enableAsyncTraces=O,t.disableAsyncTraces=function(){return x(j,void 0)},t.resolve=vt,t.reject=_t,t.future=function(){var t=new ht;return{resolve:function(e){return t._resolve(e)},promise:t}},t.never=mt,t.fulfill=wt,t.all=bt,t.race=gt,t.isFulfilled=u,t.isRejected=s,t.isSettled=p,t.isPending=function(t){return(t.state()&e)>0},t.isNever=a,t.isHandled=f,t.getValue=function(t){var e=t.near();if(!u(e))throw new TypeError("getValue called on "+t);return e.value},t.getReason=function(t){var e=t.near();if(!s(e))throw new TypeError("getReason called on "+t);return h(e),e.value},t.coroutine=function(t){return function(){for(var e,n,r,o,i,c=[],u=arguments.length;u--;)c[u]=arguments[u];return e=this,n=c,r=vt,o=t.apply(e,n),i=new ht,new Vt(r,o,i).run(),i}},t.fromNode=function(t){return function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];return zt(Ht,t,this,e,new ht)}},t.runNode=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];return zt(Ht,t,this,e,new ht)},t.runPromise=function(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];return zt(Mt,t,this,e,new ht)},t.delay=function(t,e){var n,r,o,i=vt(e);return t<=0||s(i)||a(i)?i:(n=t,r=i,o=new ht,r._runAction(new Tt(n,o)),o)},t.timeout=function(t,e){var n,r,o,i,c=vt(e);return p(c)?c:(n=t,r=c,o=new ht,i=setTimeout(Nt,n,o),r._runAction(new Pt(i,o)),o)},t.any=function(t){return At(new Ft,t)},t.settle=function(t){return At(new Dt(vt,nt(t)),t)},t.merge=function(t){for(var e,n=[],r=arguments.length-1;r-- >0;)n[r]=arguments[r+1];return e=n,At(new et(new Ct(t,this),nt(e)),e)},t.shim=Wt,t.Promise=Kt,Object.defineProperty(t,"__esModule",{value:!0})});